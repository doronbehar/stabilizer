<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Stabilizer</title>
                <meta name="robots" content="noindex" />
                

        <!-- Custom HTML head -->
        

        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

                        <link rel="shortcut icon" href="favicon.png">
                <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
                <link rel="stylesheet" href="css/print.css" media="print">
        
        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
                <link rel="stylesheet" href="fonts/fonts.css">
        
        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        
            </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded "><a href="overview.html"><strong aria-hidden="true">1.</strong> Overview</a></li><li class="chapter-item expanded "><a href="getting-started.html"><strong aria-hidden="true">2.</strong> Getting Started</a></li><li class="chapter-item expanded "><a href="usage.html"><strong aria-hidden="true">3.</strong> Usage</a></li><li class="chapter-item expanded "><a href="firmware/dual_iir/index.html"><strong aria-hidden="true">4.</strong> Application: Dual-IIR</a></li><li class="chapter-item expanded "><a href="firmware/lockin/index.html"><strong aria-hidden="true">5.</strong> Application: Lockin</a></li></ol>            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                                                <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                                            </div>

                    <h1 class="menu-title">Stabilizer</h1>

                    <div class="right-buttons">
                                                <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                                                                        <a href="https://github.com/quartiq/stabilizer" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>
                                                
                    </div>
                </div>

                                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>
                
                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="overview"><a class="header" href="#overview">Overview</a></h1>
<p>Stabilizer is a flexible tool designed for quantum physics experiments. Fundamentally, Stabilizer
samples up two two analog input signals, performs digital signal processing internally, and then
generates up to two output signals.</p>
<p>Stabilizer firmware supports run-time configuration of the internal signal processing algorithms,
which allows for a wide variety of experimental uses, such as digital filter design or
implementation of digital lockin schemes.</p>
<p>This documentation is intended to bring a user up to speed on using Stabilizer and the firmware
provided by QUARTIQ and contributors.</p>
<h1 id="hardware"><a class="header" href="#hardware">Hardware</a></h1>
<p>The Stabilizer hardware is managed via a <a href="https://github.com/sinara-hw/Stabilizer">separate repository</a>.
Some information about the hardware is gathered in the <a href="https://github.com/sinara-hw/Stabilizer/wiki">Stabilizer wiki</a>. More detailed data, measurements, discussions, and tests have been posted in the <a href="https://github.com/sinara-hw/Stabilizer/issues?q=is%3Aissue">Stabilizer issue tracker</a>.</p>
<p><a href="https://github.com/sinara-hw/Stabilizer"><img src="https://github.com/sinara-hw/Stabilizer/wiki/Stabilizer_v1.0_top_small.jpg" alt="Hardware" /></a></p>
<p>Stabilizer can be extended and coupled with a mezzanine board. One such mezzanine is the DDS upconversion/downconversion frontend Pounder. The Pounder hardware is managed via a <a href="https://github.com/sinara-hw/Pounder">separate repository</a>, again with <a href="https://github.com/sinara-hw/Pounder/wiki">wiki</a> and <a href="https://github.com/sinara-hw/Pounder/issues?q=is%3Aissue">issue tracker</a>.</p>
<h1 id="applications"><a class="header" href="#applications">Applications</a></h1>
<p>This firmware offers a library of hardware and software functionality targeting the use of the Stabilizer hardware in various digital signal processing applications commonly occurring in Quantum Technology.
It provides abstractions over the fast analog inputs and outputs, time stamping, Pounder DDS interfaces and a collection of tailored and optimized digital signal processing algorithms (IIR, FIR, Lockin, PLL, reciprocal PLL, Unwrapper, Lowpass, Cosine-Sine, Atan2) in the <a href="firmware/idsp/index.html"><code>idsp</code> crate</a>.
An application, which is the compiled firmware running on the device, can compose and configure these hardware and software components to implement different use cases.
Several applications are provided by default.</p>
<p>The following documentation links contain the application-specific settings and telemetry
information.</p>
<table><thead><tr><th align="center">Application</th><th align="left">Description</th></tr></thead><tbody>
<tr><td align="center"><a href="firmware/dual_iir/index.html"><code>dual-iir</code></a></td><td align="left">Two channel biquad IIR filter</td></tr>
<tr><td align="center"><a href="firmware/lockin/index.html"><code>lockin</code></a></td><td align="left">Lockin amplifier support various various reference sources</td></tr>
</tbody></table>
<h2 id="library-documentation"><a class="header" href="#library-documentation">Library Documentation</a></h2>
<p>The Stabilizer library docs contain documentation for common components used in all Stabilizer
applications.</p>
<p>The Stabilizer library documentation is available <a href="firmware/stabilizer/index.html">here</a>.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="getting-started"><a class="header" href="#getting-started">Getting Started</a></h1>
<p>There are a number of steps that must be completed when first getting started with Stabilizer.</p>
<ol>
<li>Update the Stabilizer Application
<ol>
<li>Build the application by compiling the source code.</li>
<li>Upload the application and programming it onto the device.</li>
</ol>
</li>
<li>Set up MQTT for telemetry and configuration.</li>
</ol>
<p>The following sections will walk you through completing each of these steps.</p>
<h1 id="update-stabilizer"><a class="header" href="#update-stabilizer">Update Stabilizer</a></h1>
<p>Firmware is compiled and loaded onto Stabilizer to program a specific application.</p>
<p>After receiving the Stabilizer hardware, you will need to flash firmware onto the device to use your
desired application.</p>
<h2 id="building-firmware"><a class="header" href="#building-firmware">Building Firmware</a></h2>
<ol>
<li>Clone or download <a href="https://github.com/quartiq/stabilizer">stabilizer</a></li>
</ol>
<pre><code class="language-bash">git clone https://github.com/quartiq/stabilizer
</code></pre>
<ol start="2">
<li>
<p>Get <a href="https://rustup.rs/">rustup</a></p>
<ul>
<li>The minimum supported Rust version (MSRV) is 1.52.0</li>
</ul>
</li>
<li>
<p>Install target support</p>
</li>
</ol>
<pre><code class="language-bash">rustup target add thumbv7em-none-eabihf
</code></pre>
<ol start="4">
<li>Build Firmware with an optionally-specified MQTT broker IP.</li>
</ol>
<pre><code class="language-bash"># Bash
BROKER=&quot;10.34.16.10&quot; cargo build --release

# Powershell
# Note: This sets the broker for all future builds as well.
$env:BROKER='10.34.16.10'; cargo build --release
</code></pre>
<h2 id="uploading-firmware"><a class="header" href="#uploading-firmware">Uploading Firmware</a></h2>
<p>Firmware is loaded onto stabilizer utilizing an ST-Link (V2-1 or greater) JTAG programmer.</p>
<ul>
<li>If a programmer is not available, please see the <a href="getting-started.html#alternative-using-usb">alternative method</a></li>
</ul>
<p>Ensure the ST-Link is connected to Stabilizer as shown below.</p>
<p><img src="assets/stabilizer-jtag.jpg" alt="JTAG Connection" /></p>
<p>All of the instructions below assume you have properly <a href="getting-started.html#building-firmware"><code>built the firmware</code></a>.</p>
<p>Substitute <code>dual-iir</code> below with the application name you are flashing.</p>
<ol>
<li>Install <a href="https://github.com/rust-embedded/cargo-binutils/">cargo-binutils</a></li>
</ol>
<pre><code class="language-bash">cargo install cargo-binutils
rustup component add llvm-tools-preview
</code></pre>
<ol start="2">
<li>Generate the binary file</li>
</ol>
<pre><code class="language-bash"># Bash
BROKER=&quot;10.34.16.10&quot; cargo objcopy --release --bin dual-iir -- -O binary dual-iir.bin

# Powershell
$env:BROKER='10.34.16.10'; cargo objcopy --release --bin dual-iir -- -O binary dual-iir.bin
</code></pre>
<ol start="3">
<li>Copy <code>dual-iir.bin</code> into the ST-Link drive on your computer.</li>
</ol>
<h3 id="alternative-using-usb"><a class="header" href="#alternative-using-usb">Alternative: Using USB</a></h3>
<p>If an ST-Link V2-1 or above is not available, you can upload firmware using a micro USB cable
plugged in to the front of Stabilizer.</p>
<ol>
<li>Install the DFU USB tool <a href="http://dfu-util.sourceforge.net"><code>dfu-util</code></a></li>
<li>Connect to the Micro USB connector below the RJ45</li>
<li>Short JC2/BOOT</li>
<li>Perform the Device Firmware Upgrade (DFU)</li>
</ol>
<pre><code class="language-bash">dfu-util -a 0 -s 0x08000000:leave -D dual-iir.bin
</code></pre>
<h3 id="alternative-firmware-development--debug"><a class="header" href="#alternative-firmware-development--debug">Alternative: Firmware Development / Debug</a></h3>
<p>The below instructions are useful for debugging or developing firmware</p>
<p>For an interactive flash experience with live logging, utilize <code>probe-run</code> as follows.</p>
<ol>
<li>Install <code>probe-run</code></li>
</ol>
<pre><code class="language-bash">cargo install probe-run
</code></pre>
<ol start="2">
<li>Build and run firmware on the device</li>
</ol>
<pre><code class="language-bash"># Bash
BROKER=&quot;10.34.16.10&quot; cargo run --release --bin dual-iir

# Powershell
$Env:BROKER='10.34.16.10'; cargo run --release --bin dual-iir
</code></pre>
<ol start="3">
<li>When using debug (non <code>--release</code>) mode, decrease the sampling frequency significantly.
The added error checking code and missing optimizations may lead to the code
missing deadlines and panicing.</li>
</ol>
<h1 id="set-up-and-test-mqtt"><a class="header" href="#set-up-and-test-mqtt">Set up and test MQTT</a></h1>
<h2 id="set-up-the-broker"><a class="header" href="#set-up-the-broker">Set up the Broker</a></h2>
<p>Stabilizer requires an MQTT broker that supports MQTTv5. <a href="https://mosquitto.org/">Mosquitto</a> has
been used during development, but any MQTTv5 broker is supported.</p>
<blockquote>
<p><em>Note</em>: Mosquitto version 1 only supports MQTTv3.1. If using Mosquitto, ensure version 2.0.0 or
later is used.</p>
</blockquote>
<p>Stabilizer utilizes a static IP address for broker configuration. Ensure the IP address was
<a href="getting-started.html#building-firmware">configured</a> properly to point to your broker before continuing.</p>
<p>We recommend running Mosquitto through <a href="https://docker.com">Docker</a> to easily run Mosquitto on
Windows, Linux, and OSX. After docker has been installed, run the following command from
the <code>stabilizer</code> repository:</p>
<pre><code class="language-bash"># Bash
docker run -p 1883:1883 --name mosquitto -v `pwd`/mosquitto.conf:/mosquitto/config/mosquitto.conf -v /mosquitto/data -v /mosquitto/log eclipse-mosquitto:2

# Powershell
docker run -p 1883:1883 --name mosquitto -v ${pwd}/mosquitto.conf:/mosquitto/config/mosquitto.conf -v /mosquitto/data -v /mosquitto/log eclipse-mosquitto:2
</code></pre>
<p>This command will create a container named <code>mosquitto</code> that can be stopped and started easily via
docker.</p>
<h2 id="test-the-connection"><a class="header" href="#test-the-connection">Test the Connection</a></h2>
<p>Once your broker is running, test that Stabilizer is properly connected to it.</p>
<p>To do this, we will check that Stabilizer is reporting telemetry on the following topic:</p>
<pre><code>dt/sinara/dual-iir/00-11-22-33-44-55/telemetry
</code></pre>
<blockquote>
<p><strong>Note</strong>: The telemetry topic will be different based on the programmed application and the MAC address
of the device.</p>
</blockquote>
<p>Download <a href="http://mqtt-explorer.com/">MQTT-Explorer</a> to observe which topics have been posted to the
Broker.</p>
<p><img src="assets/mqtt-explorer.png" alt="MQTT Explorer Configuration" /></p>
<blockquote>
<p><strong>Note</strong>: Use the same broker address that you defined in the firmware for MQTT explorer.</p>
</blockquote>
<p>Telemetry messages should come in approximately every 10 seconds when Stabilizer has connected to
the broker.  Once you observe incoming telemetry, Stabilizer has been properly configured and is
operational.</p>
<div style="break-before: page; page-break-before: always;"></div><h3 id="table-of-contents"><a class="header" href="#table-of-contents">Table of Contents</a></h3>
<ul>
<li><a href="usage.html#miniconf-run-time-settings">Miniconf Run-time Settings</a>
<ul>
<li><a href="usage.html#installation">Installation</a></li>
<li><a href="usage.html#usage">Usage</a></li>
</ul>
</li>
<li><a href="usage.html#iir-configuration">IIR Configuration</a></li>
<li><a href="usage.html#telemetry">Telemetry</a></li>
<li><a href="usage.html#livestream">Livestream</a></li>
</ul>
<h1 id="miniconf-run-time-settings"><a class="header" href="#miniconf-run-time-settings">Miniconf Run-time Settings</a></h1>
<p>Stabilizer supports run-time settings configuration using MQTT.</p>
<p>Settings can be stored in the MQTT broker so that they are automatically applied whenever
Stabilizer reboots and connects. This is referred to as &quot;retained&quot; settings. Broker implementations
may optionally store these retained settings as well such that they will be reapplied between
restarts of the MQTT broker.</p>
<p>Settings are specific to a device. Any settings configured for one Stabilizer will not be applied
to another. Disambiguation of devices is done by using Stabilizer's MAC address.</p>
<p>Settings are specific to an application. If two identical settings exist for two different
applications, each application maintains its own independent value.</p>
<h2 id="installation"><a class="header" href="#installation">Installation</a></h2>
<p>Install the Miniconf configuration utilities using a virtual environment:</p>
<pre><code>python -m venv --system-site-packages vpy

# Refer to https://docs.python.org/3/tutorial/venv.html for more information on activating the
# virtual environment. This command is different on different platforms.
./vpy/Scripts/activate
</code></pre>
<p>Next, install prerequisite packages</p>
<pre><code>python -m pip install -r scripts/requirements.txt
</code></pre>
<p>To use <code>miniconf</code>, execute it as follows:</p>
<pre><code>python -m miniconf --help
</code></pre>
<p>Miniconf also exposes a programmatic Python API, so it's possible to write automation scripting of
Stabilizer as well.</p>
<h2 id="usage"><a class="header" href="#usage">Usage</a></h2>
<p>The Miniconf Python utility utilizes a unique &quot;device prefix&quot;. The device prefix is always of the
form <code>dt/sinara/&lt;app&gt;/&lt;mac-address&gt;</code>, where <code>&lt;app&gt;</code> is the name of the application and
<code>&lt;mac-address&gt;</code> is the MAC address of the device, formatted with delimiting dashes.</p>
<p>Settings have a <code>path</code> and a <code>value</code> being configured. The <code>value</code> parameter is JSON-encoded data
and the <code>path</code> value is a path-like string.</p>
<p>As an example, for configuring <code>dual-iir</code>'s <code>stream_target</code>, the following information would be
used:</p>
<ul>
<li><code>path</code> = <code>stream_target</code></li>
<li><code>value</code> = <code>{&quot;ip&quot;: [192, 168, 0, 1], &quot;port&quot;: 4000}</code></li>
</ul>
<pre><code>python -m miniconf --broker 10.34.16.10 dt/sinara/dual-iir/00-11-22-33-44-55 stream_target='{&quot;ip&quot;: [10, 34, 16, 123], &quot;port&quot;: 4000}'

Where `10.34.16.10` is the MQTT broker address that matches the one configured in the source code and `10.34.16.123` and `4000` are the desire stream target IP and port.
</code></pre>
<p>The prefix can be found for a specific device by looking at the topic on which telemetry that is
being published.</p>
<p>Refer to the <a href="overview.html#applications">application documentation</a> for the exact settings and values exposed
for each application.</p>
<p>The rules for constructing <code>path</code> values are documented in <a href="https://github.com/quartiq/miniconf#settings-paths"><code>miniconf</code>'s
documentation</a></p>
<p>Refer to the documentation for <a href="firmware/miniconf/enum.Error.html">Miniconf</a> for a
description of the possible error codes that Miniconf may return if the settings update was
unsuccessful.</p>
<h1 id="iir-configuration"><a class="header" href="#iir-configuration">IIR Configuration</a></h1>
<p>For the <code>dual-iir</code> application, a Python utility has been written to easily configure the IIR
filters for a variety of filtering and control applications.</p>
<p>The script is located in <code>scripts/dual_iir_configuration.py</code>.</p>
<p>To use the script, install dependencies:</p>
<pre><code class="language-bash">python -m venv --system-site-packages vpy

# Refer to https://docs.python.org/3/tutorial/venv.html for more information on activating the
# virtual environment. This command is different on different platforms.
./vpy/Scripts/activate

python -m pip install scripts/requirements.txt
</code></pre>
<p>Then, use the built-in help to learn how the utility can automatically configure your IIR filters
for you:</p>
<pre><code class="language-bash">python scripts/dual_iir_configuration.py --help
</code></pre>
<h1 id="telemetry"><a class="header" href="#telemetry">Telemetry</a></h1>
<p>Stabilizer applications publish telemetry utilizes MQTT for managing run-time settings configurations as well as live telemetry
reporting.</p>
<p>Telemetry is defined as low rate, general health information. It is not intended for high throughput
or efficiency. Telemetry is generally used to determine that the device is functioning nominally.</p>
<p>Stabilizer applications publish telemetry over MQTT at a set rate. Telemetry data units are defined
by the application. All telemetry is reported using standard JSON format.</p>
<p>Telemetry is intended for low-bandwidth monitoring. It is not intended to transfer large amounts of
data and uses a minimal amount of bandwidth. Telemetry is published using &quot;best effort&quot; semantics -
individual messages may be dropped or Stabilizer may fail to publish telemetry due to internal
buffering requirements.</p>
<p>In its most basic form, telemetry publishes the latest ADC input voltages, DAC output voltages, and
digital input states.</p>
<p>Refer to the respective <a href="overview.html#applications">application documentation</a> for more information on telemetry.</p>
<h1 id="livestream"><a class="header" href="#livestream">Livestream</a></h1>
<p>Stabilizer supports livestream capabilities for streaming real-time data over UDP. The livestream is
intended to be a high-bandwidth mechanism to transfer large amounts of data from Stabilizer to a
host computer for further analysis.</p>
<p>Livestreamed data is sent with &quot;best effort&quot; - it's possible that data may be lost either due to
network congestion or by Stabilizer.</p>
<p>Refer to the the respective <a href="overview.html#applications">application documentation</a> for more information.</p>
<div style="break-before: page; page-break-before: always;"></div><!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="Dual IIR"><meta name="keywords" content="rust, rustlang, rust-lang, dual_iir"><title>dual_iir - Rust</title><link rel="stylesheet" type="text/css" href="../normalize.css"><link rel="stylesheet" type="text/css" href="../rustdoc.css" id="mainThemeStyle"><link rel="stylesheet" type="text/css" href="../light.css"  id="themeStyle"><link rel="stylesheet" type="text/css" href="../dark.css" disabled ><link rel="stylesheet" type="text/css" href="../ayu.css" disabled ><script id="default-settings" ></script><script src="../storage.js"></script><script src="../crates.js"></script><noscript><link rel="stylesheet" href="../noscript.css"></noscript><link rel="alternate icon" type="image/png" href="../favicon-16x16.png"><link rel="alternate icon" type="image/png" href="../favicon-32x32.png"><link rel="icon" type="image/svg+xml" href="../favicon.svg"><style type="text/css">#crate-search{background-image:url("../down-arrow.svg");}</style></head><body class="rustdoc mod crate"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="sidebar"><div class="sidebar-menu" role="button">&#9776;</div><a href='../dual_iir/index.html'><div class='logo-container rust-logo'><img src='../rust-logo.png' alt='logo'></div></a><h2 class="location">Crate dual_iir</h2><div class="block version"><div class="narrow-helper"></div><p>Version 0.5.0</p></div><div class="sidebar-elems"><a id="all-types" href="firmware/dual_iir/all.html"><p>See all dual_iir's items</p></a><div class="block items"><ul><li><a href="firmware/dual_iir/index.html#modules">Modules</a></li><li><a href="firmware/dual_iir/index.html#structs">Structs</a></li><li><a href="firmware/dual_iir/index.html#constants">Constants</a></li></ul></div><div id="sidebar-vars" data-name="dual_iir" data-ty="mod" data-relpath=""></div><script defer src="sidebar-items.js"></script></div></nav><div class="theme-picker"><button id="theme-picker" aria-label="Pick another theme!" aria-haspopup="menu" title="themes"><img width="18" height="18" alt="Pick another theme!" src="firmware/dual_iir/../brush.svg"></button><div id="theme-choices" role="menu"></div></div><nav class="sub"><form class="search-form"><div class="search-container"><div><select id="crate-search"><option value="All crates">All crates</option></select><input class="search-input" name="search" disabled autocomplete="off" spellcheck="false" placeholder="Click or press ‘S’ to search, ‘?’ for more options…" type="search"></div><button type="button" id="help-button" title="help">?</button><a id="settings-menu" href="firmware/dual_iir/../settings.html" title="settings"><img width="18" height="18" alt="Change settings" src="firmware/dual_iir/../wheel.svg"></a></div></form></nav><section id="main" class="content"><h1 class="fqn"><span class="in-band">Crate <a class="mod" href="firmware/dual_iir/index.html#">dual_iir</a><button id="copy-path" onclick="copy_path(this)" title="Copy item path to clipboard"><img src="firmware/dual_iir/../clipboard.svg" width="19" height="18" alt="Copy item path"></button></span><span class="out-of-band"><span id="render-detail"><a id="toggle-all-docs" href="javascript:void(0)" title="collapse all docs">[<span class="inner">&#x2212;</span>]</a></span><a class="srclink" href="firmware/dual_iir/../src/dual_iir/dual-iir.rs.html#1-482" title="goto source code">[src]</a></span></h1><details class="rustdoc-toggle top-doc" open><summary class="hideme"><span>Expand description</span></summary><div class="docblock"><h1 id="dual-iir" class="section-header"><a href="firmware/dual_iir/index.html#dual-iir">Dual IIR</a></h1>
<p>The Dual IIR application exposes two configurable channels. Stabilizer samples input at a fixed
rate, digitally filters the data, and then generates filtered output signals on the respective
channel outputs.</p>
<h2 id="features" class="section-header"><a href="firmware/dual_iir/index.html#features">Features</a></h2>
<ul>
<li>Two indpenendent channels</li>
<li>up to 800 kHz rate, timed sampling</li>
<li>Run-time filter configuration</li>
<li>Input/Output data streaming</li>
<li>Down to 2 µs latency</li>
<li>f32 IIR math</li>
<li>Generic biquad (second order) IIR filter</li>
<li>Anti-windup</li>
<li>Derivative kick avoidance</li>
</ul>
<h2 id="settings" class="section-header"><a href="firmware/dual_iir/index.html#settings">Settings</a></h2>
<p>Refer to the <a href="firmware/dual_iir/struct.Settings.html" title="Settings">Settings</a> structure for documentation of run-time configurable settings for this
application.</p>
<h2 id="telemetry" class="section-header"><a href="firmware/dual_iir/index.html#telemetry">Telemetry</a></h2>
<p>Refer to <a href="firmware/dual_iir/../stabilizer/net/telemetry/struct.Telemetry.html" title="Telemetry">Telemetry</a> for information about telemetry reported by this application.</p>
<h2 id="livestreaming" class="section-header"><a href="firmware/dual_iir/index.html#livestreaming">Livestreaming</a></h2>
<p>This application streams raw ADC and DAC data over UDP. Refer to
<a href="firmware/dual_iir/../stabilizer/net/data_stream/index.html">stabilizer::net::data_stream</a> for more information.</p>
</div></details><h2 id="modules" class="section-header"><a href="firmware/dual_iir/index.html#modules">Modules</a></h2>
<div class="item-table"><div class="item-left module-item"><a class="mod" href="firmware/dual_iir/app/index.html" title="dual_iir::app mod">app</a></div><div class="item-right docblock-short"><p>The RTIC application module</p>
</div></div><h2 id="structs" class="section-header"><a href="firmware/dual_iir/index.html#structs">Structs</a></h2>
<div class="item-table"><div class="item-left module-item"><a class="struct" href="firmware/dual_iir/struct.Settings.html" title="dual_iir::Settings struct">Settings</a></div><div class="item-right docblock-short"></div></div><h2 id="constants" class="section-header"><a href="firmware/dual_iir/index.html#constants">Constants</a></h2>
<div class="item-table"><div class="item-left module-item"><a class="constant" href="firmware/dual_iir/constant.BATCH_SIZE.html" title="dual_iir::BATCH_SIZE constant">BATCH_SIZE</a></div><div class="item-right docblock-short"></div><div class="item-left module-item"><a class="constant" href="firmware/dual_iir/constant.IIR_CASCADE_LENGTH.html" title="dual_iir::IIR_CASCADE_LENGTH constant">IIR_CASCADE_LENGTH</a></div><div class="item-right docblock-short"></div><div class="item-left module-item"><a class="constant" href="firmware/dual_iir/constant.SAMPLE_TICKS_LOG2.html" title="dual_iir::SAMPLE_TICKS_LOG2 constant">SAMPLE_TICKS_LOG2</a></div><div class="item-right docblock-short"></div><div class="item-left module-item"><a class="constant" href="firmware/dual_iir/constant.SCALE.html" title="dual_iir::SCALE constant">SCALE</a></div><div class="item-right docblock-short"></div></div></section><section id="search" class="content hidden"></section><div id="rustdoc-vars" data-root-path="../" data-current-crate="dual_iir" data-search-index-js="../search-index.js" data-search-js="../search.js"></div>
    <script src="../main.js"></script>
</body></html><div style="break-before: page; page-break-before: always;"></div><!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="Lockin"><meta name="keywords" content="rust, rustlang, rust-lang, lockin"><title>lockin - Rust</title><link rel="stylesheet" type="text/css" href="../normalize.css"><link rel="stylesheet" type="text/css" href="../rustdoc.css" id="mainThemeStyle"><link rel="stylesheet" type="text/css" href="../light.css"  id="themeStyle"><link rel="stylesheet" type="text/css" href="../dark.css" disabled ><link rel="stylesheet" type="text/css" href="../ayu.css" disabled ><script id="default-settings" ></script><script src="../storage.js"></script><script src="../crates.js"></script><noscript><link rel="stylesheet" href="../noscript.css"></noscript><link rel="alternate icon" type="image/png" href="../favicon-16x16.png"><link rel="alternate icon" type="image/png" href="../favicon-32x32.png"><link rel="icon" type="image/svg+xml" href="../favicon.svg"><style type="text/css">#crate-search{background-image:url("../down-arrow.svg");}</style></head><body class="rustdoc mod crate"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="sidebar"><div class="sidebar-menu" role="button">&#9776;</div><a href='../lockin/index.html'><div class='logo-container rust-logo'><img src='../rust-logo.png' alt='logo'></div></a><h2 class="location">Crate lockin</h2><div class="block version"><div class="narrow-helper"></div><p>Version 0.5.0</p></div><div class="sidebar-elems"><a id="all-types" href="firmware/lockin/all.html"><p>See all lockin's items</p></a><div class="block items"><ul><li><a href="firmware/lockin/index.html#modules">Modules</a></li><li><a href="firmware/lockin/index.html#structs">Structs</a></li><li><a href="firmware/lockin/index.html#enums">Enums</a></li><li><a href="firmware/lockin/index.html#constants">Constants</a></li></ul></div><div id="sidebar-vars" data-name="lockin" data-ty="mod" data-relpath=""></div><script defer src="sidebar-items.js"></script></div></nav><div class="theme-picker"><button id="theme-picker" aria-label="Pick another theme!" aria-haspopup="menu" title="themes"><img width="18" height="18" alt="Pick another theme!" src="firmware/lockin/../brush.svg"></button><div id="theme-choices" role="menu"></div></div><nav class="sub"><form class="search-form"><div class="search-container"><div><select id="crate-search"><option value="All crates">All crates</option></select><input class="search-input" name="search" disabled autocomplete="off" spellcheck="false" placeholder="Click or press ‘S’ to search, ‘?’ for more options…" type="search"></div><button type="button" id="help-button" title="help">?</button><a id="settings-menu" href="firmware/lockin/../settings.html" title="settings"><img width="18" height="18" alt="Change settings" src="firmware/lockin/../wheel.svg"></a></div></form></nav><section id="main" class="content"><h1 class="fqn"><span class="in-band">Crate <a class="mod" href="firmware/lockin/index.html#">lockin</a><button id="copy-path" onclick="copy_path(this)" title="Copy item path to clipboard"><img src="firmware/lockin/../clipboard.svg" width="19" height="18" alt="Copy item path"></button></span><span class="out-of-band"><span id="render-detail"><a id="toggle-all-docs" href="javascript:void(0)" title="collapse all docs">[<span class="inner">&#x2212;</span>]</a></span><a class="srclink" href="firmware/lockin/../src/lockin/lockin.rs.html#1-520" title="goto source code">[src]</a></span></h1><details class="rustdoc-toggle top-doc" open><summary class="hideme"><span>Expand description</span></summary><div class="docblock"><h1 id="lockin" class="section-header"><a href="firmware/lockin/index.html#lockin">Lockin</a></h1>
<p>THe <code>lockin</code> application implements a lock-in amplifier using either an external or internally
generated</p>
<h2 id="features" class="section-header"><a href="firmware/lockin/index.html#features">Features</a></h2>
<ul>
<li>Up to 800 kHz sampling</li>
<li>Up to 400 kHz modulation frequency</li>
<li>Supports internal and external reference sources:
<ol>
<li>Internal: Generate reference internally and output on one of the channel outputs</li>
<li>External: Reciprocal PLL, reference input applied to DI0.</li>
</ol>
</li>
<li>Adjustable PLL and locking time constants</li>
<li>Adjustable phase offset and harmonic index</li>
<li>Run-time configurable output modes (in-phase, quadrature, magnitude, log2 power, phase, frequency)</li>
<li>Input/output data streamng via UDP</li>
</ul>
<h2 id="settings" class="section-header"><a href="firmware/lockin/index.html#settings">Settings</a></h2>
<p>Refer to the <a href="firmware/lockin/struct.Settings.html" title="Settings">Settings</a> structure for documentation of run-time configurable settings for this
application.</p>
<h2 id="telemetry" class="section-header"><a href="firmware/lockin/index.html#telemetry">Telemetry</a></h2>
<p>Refer to <a href="firmware/lockin/../stabilizer/net/telemetry/struct.Telemetry.html" title="Telemetry">Telemetry</a> for information about telemetry reported by this application.</p>
<h2 id="livestreaming" class="section-header"><a href="firmware/lockin/index.html#livestreaming">Livestreaming</a></h2>
<p>This application streams raw ADC and DAC data over UDP. Refer to
<a href="firmware/lockin/../stabilizer/net/data_stream/index.html">stabilizer::net::data_stream</a> for more information.</p>
</div></details><h2 id="modules" class="section-header"><a href="firmware/lockin/index.html#modules">Modules</a></h2>
<div class="item-table"><div class="item-left module-item"><a class="mod" href="firmware/lockin/app/index.html" title="lockin::app mod">app</a></div><div class="item-right docblock-short"><p>The RTIC application module</p>
</div></div><h2 id="structs" class="section-header"><a href="firmware/lockin/index.html#structs">Structs</a></h2>
<div class="item-table"><div class="item-left module-item"><a class="struct" href="firmware/lockin/struct.Settings.html" title="lockin::Settings struct">Settings</a></div><div class="item-right docblock-short"></div></div><h2 id="enums" class="section-header"><a href="firmware/lockin/index.html#enums">Enums</a></h2>
<div class="item-table"><div class="item-left module-item"><a class="enum" href="firmware/lockin/enum.Conf.html" title="lockin::Conf enum">Conf</a></div><div class="item-right docblock-short"></div><div class="item-left module-item"><a class="enum" href="firmware/lockin/enum.LockinMode.html" title="lockin::LockinMode enum">LockinMode</a></div><div class="item-right docblock-short"></div></div><h2 id="constants" class="section-header"><a href="firmware/lockin/index.html#constants">Constants</a></h2>
<div class="item-table"><div class="item-left module-item"><a class="constant" href="firmware/lockin/constant.ADC_SAMPLE_TICKS_LOG2.html" title="lockin::ADC_SAMPLE_TICKS_LOG2 constant">ADC_SAMPLE_TICKS_LOG2</a></div><div class="item-right docblock-short"></div><div class="item-left module-item"><a class="constant" href="firmware/lockin/constant.BATCH_SIZE_SIZE_LOG2.html" title="lockin::BATCH_SIZE_SIZE_LOG2 constant">BATCH_SIZE_SIZE_LOG2</a></div><div class="item-right docblock-short"></div></div></section><section id="search" class="content hidden"></section><div id="rustdoc-vars" data-root-path="../" data-current-crate="lockin" data-search-index-js="../search-index.js" data-search-js="../search.js"></div>
    <script src="../main.js"></script>
</body></html>
                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                        
                        
                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                
                            </nav>

        </div>

        
        
        
                <script type="text/javascript">
            window.playground_copyable = true;
        </script>
        
        
                <script src="elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="searcher.js" type="text/javascript" charset="utf-8"></script>
        
        <script src="clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
        
                        <script type="text/javascript">
        window.addEventListener('load', function() {
            window.setTimeout(window.print, 100);
        });
        </script>
                
    </body>
</html>
